(function(){"use strict";var t={4783:function(t,e,s){var a=s(6369),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container container-main",attrs:{id:"app"}},[e("my-nav-bar",{attrs:{login:t.login,iss:t.issWorking,"show-copies":t.showCopies,"selected-semester":t.selectedSemester,"login-error-message":t.loginErrorMessage},on:{"select-semester":t.selectSemesterClick,"show-copies-click":t.showCopiesClick,"iss-click":t.winLoaderShow,logout:t.logout,"save-settings":t.saveSettings,"get-iss-works":t.getIssWorks,"add-self-lesson":()=>{this.$bvModal.show("selfleswin")},"get-api-token":t.getApiToken},model:{value:t.remember,callback:function(e){t.remember=e},expression:"remember"}}),e("rasp-loading-show",{attrs:{loading:t.loading,message:t.winStud.message}}),e("st-rasp-win",{attrs:{"win-stud":t.winStud,login:t.login},on:{"get-st-rasp":({group:e,date:s})=>{t.getStRasp(e,s)}}}),e("kab-win",{attrs:{"win-kab":t.winKab},on:{"set-day":e=>{t.winKab.current.cDay=e},"set-kab":e=>{t.winKab.current.kab=e},"set-corp":e=>{t.getKab(t.winKab.day,e)},"change-kab":t.changeKab,"change-kab-cancel":t.changeKabCancel}}),e("log-win",{attrs:{"win-log":t.winLog}}),e("sync-win",{attrs:{"win-sync":t.winSync},on:{"lesson-select":t.winSyncLessonClick}}),e("self-les-win",{attrs:{days:t.days},on:{"lesson-add":t.addSelfLesson,"lesson-add-multi":t.lessonAddMulti}}),e("loader-win",{attrs:{messages:t.messages}}),t.raspSeartchMode?e("lesson-copy-block",{attrs:{clipboard:t.clipboard,"copy-count":t.copyCount},on:{exit:function(e){t.raspSeartchMode=!1,t.clipboard={},t.loadData()}}}):t._e(),t._l(t.filteredDays,(function(s,a){return e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],key:a},[e("day-name",{attrs:{id:a,name:s.day},on:{"btn-click":function(e){return t.sendDayWork(a)}}}),t._l(s.lessons,(function(n,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:""!=n.predm&&(!n.copied||n.copied&&t.showCopies)||t.raspSeartchMode,expression:"(lesson.predm != '' && (!lesson.copied || (lesson.copied && showCopies))) || raspSeartchMode"}],key:i,staticClass:"lesson",class:n.stkab?"besy":""==n.predm?"free":""},[t.raspSeartchMode?t._e():e("lesson-menu",{attrs:{id:{idd:a,idl:i},lesson:n},on:{close:function(e){return t.closeMenus(n)},"kab-click":function(e){t.getKab(s.day,n.kab,n,i),n.showmenu=!1},"strasp-click":function(e){t.getStRasp(n.groups[0],t.dateFormat(s.day)),n.showmenu=!1},"work-click":function(e){t.sendOneWork(a,i),n.showmenu=!1},"copy-click":function(e){t.getStRaspAll(n,a),n.showmenu=!1,t.copyCount=0},"del-click":function(e){t.delLesson(n,s.day,a,i),n.showmenu=!1}}}),e("div",{staticClass:"stkab"},[t._v(t._s("a"==n.stkab[1]?"Teams":n.stkab))]),e("lesson-name",{attrs:{lesson:n},on:{click:()=>{}}}),e("lesson-content",{attrs:{lesson:n},on:{"kab-click":function(e){return t.getKab(s.day,n.kab,n,i)},"set-win-log":e=>{t.winLog.log=e},"iss-check-click":function(e){return t.issCheckClick(n)}}}),t._l(n.variants,(function(s){return e("a",{key:s.i,staticClass:"btn btn-sm btn-warning",staticStyle:{"margin-right":"5px"},style:n.i==s.i?"font-weight: 600;":"",attrs:{href:"javascript://"},on:{click:function(e){n.i=s.i,t.sendOneWork(a,i)}}},[t._v(t._s(s.groups))])})),""==n.predm&&t.raspSeartchMode?e("div",{staticStyle:{width:"fit-content",position:"relative",margin:"auto",height:"0",top:"-11px"}}):t._e()],2)})),e("hr")],2)})),e("div",{staticStyle:{position:"fixed",bottom:"70px"}},[t.login?t._e():e("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){t.getKab(t.today(),t.prompt("Введите номер корпуса","16"),null,Number(t.prompt("Введите номер занятия","1"))-1)}}},[t._v("Расписание кабинетов")])],1),t.raspSeartchMode?t._e():e("my-week-selector",{on:{"change-week":t.changeWeek}})],2)},i=[],o=(s(7658),function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-right":"32px"},on:{click:function(e){return t.$emit("click")}}},[e("b",[t._v(t._s(t.lesson.time))]),t._v(" "+t._s(t.lesson.predm)+" ")])}),r=[],l={name:"lessonName",props:{lesson:Object}},c=l,d=s(1001),u=(0,d.Z)(c,o,r,!1,null,null,null),b=u.exports,p=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-left":"6px"}},[e("span",{staticStyle:{"font-size":"80%"}},[e("span",{staticStyle:{"font-weight":"bold"},domProps:{innerHTML:t._s(t.lesson.kab+" ")}}),(t.lesson?.oldkab,e("span",{staticStyle:{"font-weight":"bold","text-decoration":"line-through",color:"red"},domProps:{innerHTML:t._s(t.lesson.oldkab)}})),t._v(" "+t._s(t.lesson.type.slice(0,3))+" "+t._s(t.lesson.groups.join(", "))+" "),1==t.lesson.in_iss?e("span",{staticStyle:{color:"green"},attrs:{title:"Занятие уже в журнале. Кликнуть для снятия отметки."},on:{click:function(e){return t.issCheckClick()}}},[e("svg",{staticClass:"bi bi-check",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"}})])]):t._e(),t.hideCopyLabel?t._e():e("span",{style:"color: "+("blue"==t.lesson.color?"#0d6efd":t.lesson.color)+"; "+(t.lesson.log?"text-decoration: underline; cursor: pointer;":""),domProps:{innerHTML:t._s(t.lesson.status)},on:{click:function(e){return t.winLogShow(t.lesson.log)}}})])])},h=[],m={name:"lessonContent",props:{lesson:Object,hideCopyLabel:{default:!1,type:Boolean}},methods:{winLogShow(t){t&&(this.$emit("set-win-log",t),this.$bvModal.show("logwin"))},issCheckClick(){this.$emit("iss-check-click")}}},g=m,w=(0,d.Z)(g,p,h,!1,null,null,null),v=w.exports,f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"lessonmenu",class:t.lesson.showmenu?"showbuttons":"closebuttons"},[e("b-button-group",{staticClass:"shadow-sm",staticStyle:{border:"1px solid #d3d4d5"},attrs:{size:"sm"}},[e("b-button",{staticStyle:{width:"30px",height:"34.5px","border-right":"2px solid #d3d4d5"},attrs:{variant:"light",title:"меню"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.lesson.showmenu?"»":"«"))]),e("b-button",{attrs:{variant:"light",title:"Расписание и замена кабинетов"},on:{click:function(e){return t.$emit("kab-click")}}},[e("img",{staticStyle:{width:"24px"},attrs:{src:s(2781)}})]),e("b-button",{attrs:{variant:"light",title:"Расписание группы студентов"},on:{click:function(e){return t.$emit("strasp-click")}}},[e("img",{staticStyle:{width:"24px"},attrs:{src:s(8324)}})]),e("b-button",{attrs:{variant:"light",title:"Копировать или перенести занятие - функция в разработке",id:`copylessonid_${t.id.idd}_${t.id.idl}`},on:{click:function(e){return t.$emit("copy-click")}}},[e("img",{staticStyle:{width:"24px"},attrs:{src:s(8631)}})]),e("b-button",{attrs:{variant:"light",title:"Удалить занятие",id:`lessondelid_${t.id.idd}_${t.id.idl}`},on:{click:t.delClick}},[e("img",{staticStyle:{width:"24px"},attrs:{src:s(4828)}})]),e("b-button",{attrs:{variant:"light",title:"Записать занятие в Журнал преподавателя",id:`lessontoissid_${t.id.idd}_${t.id.idl}`},on:{click:function(e){return t.$emit("work-click")}}},[e("img",{staticStyle:{width:"24px"},attrs:{src:s(214)}})])],1)],1)},y=[],k={name:"lessonName",props:{lesson:Object,id:Object},methods:{delClick(){this.$emit("del-click")}}},_=k,S=(0,d.Z)(_,f,y,!1,null,null,null),x=S.exports,K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"lesson current"},[e("div",{staticStyle:{"padding-right":"32px"}},[e("b",[t._v("Копирование")]),t._v(" "+t._s(t.clipboard.predm)+" "),e("b",[t._v("Скопировано "+t._s(t.copyCount)+" занятий")])]),e("lesson-content",{attrs:{lesson:t.clipboard,"hide-copy-label":!0}}),e("div",{staticStyle:{width:"fit-content",position:"relative",margin:"0 15px 0 auto",height:"0",top:"-32px"}},[e("b-button",{attrs:{variant:"warning",size:"sm"},on:{click:function(e){return t.$emit("exit")}}},[t._v(" Завершить ")])],1)],1)},C=[],$={name:"lessonCopyBlock",components:{lessonContent:v},props:{clipboard:Object,copyCount:Number}},D=$,E=(0,d.Z)(D,K,C,!1,null,null,null),M=E.exports;const A="",L={data:()=>({raspSeartchMode:!1,clipboard:{},copyCount:0}),methods:{copyToLesson(t,e,s,a){t.groups=this.clipboard.groups,this.copyCount++,"<"==this.clipboard.kab[0]?t.kab=this.clipboard.kab:t.kab=this.clipboard.kab.split("-")[0]+"-___",t.predm=this.clipboard.predm,t.type=this.clipboard.type,t.copied=!0,t.realcopy=a,t.unsaved=!0,"<"==t.kab[0]?(this.winKab.day=e,this.winKab.lesson=t,this.changeKab(t.kab)):this.getKab(e,t.kab,t,s)},async lessonAddMulti(t){this.axios.post(A+"/api/db/self/lesson/multi",{login:this.login,passwordAES:this.passwordAES,lessons:t}).then((()=>{this.loadData(),this.$bvModal.msgBoxOk("Выбранные занятия успешно добавлены",{title:"Подтверждение",size:"sm",buttonSize:"sm",okVariant:"success",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0})})).catch((t=>{console.log(t?.message)}))},async addSelfLesson(t){var e={groups:[t.lesson.groups],kab:t.lesson.kab,predm:t.lesson.predm,type:t.lesson.type,time:t.lesson.time};this.axios.post(A+"/api/db/self/lesson",{login:this.login,passwordAES:this.passwordAES,lesson:e,day:t.day}).then((()=>{this.loadData(),this.$bvModal.msgBoxOk("Занятие успешно добавлено",{title:"Подтверждение",size:"sm",buttonSize:"sm",okVariant:"success",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0})})).catch((t=>{console.log(t?.message)}))},async changeKab(t){var e=this.winKab.lesson,s={groups:e.groups,kab:e.kab,predm:e.predm,type:e.type,time:e.time,copied:e.copied,realcopy:e.realcopy};this.axios.post(A+"/api/db/changekab",{login:this.login,passwordAES:this.passwordAES,lesson:s,newkab:t,day:this.winKab.day}).then((()=>{this.winKab.lesson.copied||(this.winKab.lesson.oldkab=this.winKab.lesson.kab),this.winKab.lesson.kab=t,this.winKab.lesson.unsaved=!1,localStorage.dump=JSON.stringify(this.days)})).catch((t=>{console.log(t?.message)}))},async changeKabCancel(){this.axios.post(A+"/api/db/changekab/cancel",{login:this.login,passwordAES:this.passwordAES,lesson:this.winKab.lesson,day:this.winKab.day}).then((()=>{this.winKab.lesson.kab=this.winKab.lesson.oldkab,delete this.winKab.lesson.oldkab,localStorage.dump=JSON.stringify(this.days)})).catch((t=>{console.log(t?.message)}))},async delLesson(t,e,s,a){var n="/api/db/del";this.axios.post(A+n,{login:this.login,passwordAES:this.passwordAES,lesson:t,day:e}).then((()=>{t.copied||(this.filteredDays[s].lessons[a].deleted=!0),this.filteredDays[s].lessons[a].predm="",this.filteredDays[s].lessons[a].type="",this.filteredDays[s].lessons[a].groups=[],this.filteredDays[s].lessons[a].kab="",this.filteredDays[s].lessons[a].copied=!1,this.filteredDays[s].lessons[a].unsaved=!1,this.filteredDays[s].lessons[a].message="",this.raspSeartchMode&&this.copyCount--,localStorage.dump=JSON.stringify(this.days)})).catch((t=>{console.log(t?.message)}))}}};s(2801);const N="",O={data:()=>({login:"",passwordAES:"",loginErrorMessage:"",loading:!1,remember:!1,showCopies:!1,selectedSemester:1}),methods:{closeMenus(t={showmenu:!1}){var e=t.showmenu;this.lastmenu&&(this.lastmenu.showmenu=!1),t.showmenu=!e,this.lastmenu=t},getApiToken(){var t=JSON.parse(this.passwordAES),e=`${this.login}#${t.ct}#${t.iv}#${t.s}`;prompt("Ваш API token. Используйте его только для авторизации в сервисе через сторонние приложения. Для смены токена выйдите из приложения и зайдите повторно.",btoa(e))},async saveSettings(){this.loginErrorMessage="",this.axios.post(N+"/api/lk/login/",{text:document.getElementById("dropdown-form-password").value,login:document.getElementById("dropdown-form-login").value}).then((t=>{t.data.error?this.loginErrorMessage=t.data.error:(this.login=document.getElementById("dropdown-form-login").value,this.passwordAES=t.data.encrypted_json_str,document.querySelector('li[id="loginmenu"] ul').classList.remove("show"),this.remember?(localStorage.login=this.login,localStorage.passwordAES=this.passwordAES,localStorage.dump="",localStorage.remember="true"):(localStorage.login="",localStorage.passwordAES="",localStorage.dump="",localStorage.remember=""),this.loadData())}))},async logout(){var t=()=>{this.$pusher.unsubscribe(this.login),this.login="",this.passwordAES="",this.remember=!1,localStorage.login="",localStorage.passwordAES="",localStorage.dump="",localStorage.remember="",setTimeout((()=>{this.loadData()}),300)};this.axios.post(N+"/api/lk/logout/",{login:this.login,passwordAES:this.passwordAES}).then(t).catch((e=>{console.log(e),t()}))},winLoaderShow(){this.$bvModal.show("loaderwin")},dateFormat(t){var e=t.split("-");return`${e[2]}.${e[1]}`},today(){var t=new Date,e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),a=t.getYear()-100;return`20${a}-${s}-${e}`},showCopiesClick(t){this.showCopies=t,localStorage.showCopies=t?"true":"false"},selectSemesterClick(t){if(t>0)return this.selectedSemester=t,localStorage.selectedSemester=t,0;this.$bvModal.msgBoxConfirm("Пожалуйста, выберите семестр для журнала нагрузки.",{title:"Выберите семестр",size:"sm",buttonSize:"sm",okVariant:"primary",okTitle:"Второй",cancelTitle:"Первый",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((e=>{t=e?2:1,this.selectedSemester=t,localStorage.selectedSemester=t,this.axios.post(N+"/api/iss/closebrowser/",{username:this.login}).then((()=>{this.$bvModal.msgBoxOk("Выбран "+t+" семестр",{title:"Подтверждение",size:"sm",buttonSize:"sm",okVariant:"success",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0})})).catch(console.log)}))}},mounted(){if("true"==localStorage.showCopies?this.showCopies=!0:this.showCopies=!1,localStorage.selectedSemester)this.selectedSemester=Number(localStorage.selectedSemester);else{var t=new Date;t.getMonth()>0&&t.getMonth()<8?this.selectedSemester=2:this.selectedSemester=1,localStorage.selectedSemester=this.selectedSemester}}},T="",j=["8:20-9:50","10:00-11:30","11:45-13:15","14:00-15:30","15:45-17:15","17:20-18:50","18:55-20:25"];class I{constructor(t,e="",s="",a="",n=[]){this.time=t,this.predm=e,this.type=s,this.kab=a,this.groups=n}}function W(t){return 0==t?"Лекция":1==t?"Практическое занятие":2==t?"Лабораторная работа":void 0}function B(t){return t.split(".").reverse().join("-")}function z(t,e=0){var s=t.slice(0,-3),a=j.findIndex((t=>t.indexOf(s)>=0));return j[a+e]}function H(t){var e=t.replaceAll(", 1",". 1").replaceAll(", 2",". 2").replaceAll(", 3",". 3").replaceAll(", 4",". 4").split(", ");return e.forEach(((t,s)=>{e[s]=t.replace(". 1",", 1").replace(". 2",", 2").replace(". 3",", 3").replace(". 4",", 4")})),e}const P={data:()=>({winLog:{log:[]},winSync:{data:[]},messages:[],issWorking:!1}),methods:{sendOneWork(t,e){this.sendCommand([this.createData(t,e)],`lessontoissid_${t}_${e}`)},sendDayWork(t){var e=[],s="daytoissid_"+t,a=this.filteredDays[t].lessons.length,n=this.filteredDays[t];for(let o=0;o<a;o++){var i=n.lessons[o];(""!=i.predm&&(!i.copied||i.copied&&this.showCopies)||this.raspSeartchMode)&&e.push(this.createData(t,o))}this.sendCommand(e,s)},createData(t,e){var s=["Лекция","Практическое занятие","Лабораторная работа","","","","","","","Консультация","Экзамен","Зачет"],a=new Date(this.filteredDays[t].day).toLocaleDateString(),n=this.filteredDays[t].lessons[e];const i=["8:20-9:50","10:00-11:30","11:45-13:15","14:00-15:30","15:45-17:15","17:20-18:50","18:55-20:25"];return n.status="Передача данных...",n.color="",n.log=null,{name:n.predm,date:a,time:i.indexOf(n.time)+1,groups:n.groups.sort().join(", ").replace(", подгруппа 1",", 1 подгруппа").replace(", подгруппа 2",", 2 подгруппа"),cat:s.indexOf(n.type),kab:n.kab.replace('<a href="',"").replace('" target="_blank">Занятие удаленно в Teams</a>',""),count:2,i:n.i,id:[t,e],_id:n._id}},async sendCommand(t,e){var s={data:t,auth:{login:this.login,passwordAES:this.passwordAES,semester:this.selectedSemester}};this.issWorking=!0,document.getElementById(e).classList.add("disabled"),this.axios({method:"post",url:T+"/api/iss",timeout:6e4,data:s}).then((t=>{t.data.forEach((t=>{this.filteredDays[t.id[0]].lessons[t.id[1]].status=t.status,this.filteredDays[t.id[0]].lessons[t.id[1]].color=t.color,this.filteredDays[t.id[0]].lessons[t.id[1]].log=t.log?t.log:null,this.filteredDays[t.id[0]].lessons[t.id[1]].in_iss="red"!=t.color?1:0,this.filteredDays[t.id[0]].lessons[t.id[1]].variants=t.variants?t.variants:void 0,this.filteredDays[t.id[0]].lessons[t.id[1]].i=void 0,this.issWorking=!1,document.getElementById(e).classList.remove("disabled")}))})).catch((()=>{document.getElementById(e).classList.remove("disabled")}))},async getIssWorks(){var t={auth:{login:this.login,passwordAES:this.passwordAES,semester:this.selectedSemester}};this.issWorking=!0,this.axios({method:"post",url:T+"/api/iss/worklist",timeout:6e4,data:t}).then((t=>{this.winSync.data=t.data,this.$bvModal.show("syncwin"),this.issWorking=!1})).catch((t=>{console.log(t)}))},async winSyncLessonClick(t){var e={auth:{login:this.login,passwordAES:this.passwordAES,semester:this.selectedSemester},data:{id:t.id}};this.issWorking=!0,this.axios({method:"post",url:T+"/api/iss/worklist/lessons",timeout:6e4,data:e}).then((e=>{var s=[];e.data.forEach((e=>{for(var a=0,n=e[1];n>0;n-=2)s.push({lesson:new I(z(e[0].split(" ")[1],a),t.name,W(t.cat),e[2],H(t.groups)),day:B(e[0].split(" ")[0])}),a++})),console.log(s),this.issWorking=!1})).catch((t=>{console.log(t)}))}}},Z="",F={data:()=>({winKab:{kabs:[],dates:[],types:[],loading:!0,rasp:[],current:{kab:0,cDay:0},lesson:{},idl:0,day:""}}),methods:{async getKab(t,e,s=null,a=null){if(e.length>10)return null;var n=new Date(t).toLocaleDateString(),i=n.replaceAll(".","");this.winKab.loading=!0,s&&(this.winKab.lesson=s),a&&(this.winKab.idl=a),this.winKab.current.kab=-1,this.winKab.day=t,this.$bvModal.show("kabraspwin");var o=t=>{this.winKab.corps=t.data.corps,this.winKab.kabs=t.data.kabs,this.winKab.dates=t.data.dates,this.winKab.rasp=t.data.rasp,this.winKab.types=t.data.types,this.winKab.current.kab=t.data.kabs.findIndex((t=>t==e)),this.winKab.current.kab<0&&(this.winKab.current.kab=0),this.winKab.current.cDay=t.data.dates.findIndex((t=>t.split(" ")[1]==n.replace(".20","."))),this.winKab.current.cDay<0&&(this.winKab.current.cDay=0),this.winKab.loading=!1,setTimeout((()=>{document.querySelector('div[id="corplist"] button').addEventListener("click",(()=>{var t=document.querySelector('div[id="corplist"] button').textContent;setTimeout((()=>{document.querySelector('div[id="corplist"] ul').scrollTop=document.getElementById(`corp_${t}`).offsetTop-150}),100)})),document.querySelector('div[id="kablist"] button').addEventListener("click",(()=>{var t=document.querySelector('div[id="kablist"] button').textContent,e=this.winKab.kabs.findIndex((e=>e==t));setTimeout((()=>{document.querySelector('div[id="kablist"] ul').scrollTop=document.getElementById(`kab_${e}`).offsetTop-150}),100)})),document.querySelector('div[id="datlist"] button').addEventListener("click",(()=>{var t=document.querySelector('div[id="datlist"] button').textContent,e=this.winKab.dates.findIndex((e=>e==t));setTimeout((()=>{document.querySelector('div[id="datlist"] ul').scrollTop=document.getElementById(`dat_${e}`).offsetTop-150}),100)}))}),100)},r="dump_"+e.split("-")[0]+"_"+i;sessionStorage[r]?o({data:JSON.parse(sessionStorage[r])}):this.axios.post(Z+"/api/kab",{date:i,kab:e.split("-")[0]}).then((t=>{sessionStorage[r]=JSON.stringify(t.data),o(t)}))}}},q="",R={data:()=>({winStud:{rasp:"<br><br><br><br><br><br><br><br><br>",dates:[],loading:!0,message:"Пожалуйста, подождите..."}}),methods:{async getStRasp(t,e){this.winStud.loading=!0,this.winStud.message="Пожалуйста, подождите...",this.$bvModal.show("straspwin"),this.axios({method:"post",url:q+"/api/stud",timeout:6e4,data:{groups:[t],date:e,auth:{login:this.login}}}).then((t=>{this.winStud.rasp=t.data[0].rasp,this.winStud.dates=t.data[0].dates,this.winStud.group=t.data[0].group,this.winStud.loading=!1})).catch(console.log)},async getStRaspAll(t,e){var s=t.groups;this.loading=!0,this.winStud.message="Пожалуйста, подождите...";var a=t=>{setTimeout((()=>{window.location.href="#"+t}),300)};this.axios({method:"post",url:q+"/api/stud",timeout:3e4,data:{groups:s,date:"",auth:{login:this.login}}}).then((s=>{this.clipboard=t,this.days.forEach((t=>{t.lessons.forEach((e=>{e.stkab="",s.data.forEach((s=>{var a=s.content.find((e=>e.date==t.day));if(a){var n=a.lessons.find((t=>t.time==e.time));n&&(e.stkab+=`${n.kab} `)}}))}))})),a(e),this.loading=!1,this.raspSeartchMode=!0})).catch((t=>{console.log(t),this.loading=!1}))}}};var Y=function(){var t=this,e=t._self._c;return e("div",[e("a",{staticClass:"a-name",attrs:{name:t.id}},[t._v(".")]),e("b",{staticStyle:{"font-size":"120%"}},[t._v(t._s(t.dayName))]),e("a",{staticClass:"btn btn-link btn-sm day-btn",attrs:{id:"daytoissid_"+t.id,href:"javascript://"},on:{click:function(e){return t.$emit("btn-click",t.id)}}},[t._v("День в журнал")])])},V=[],J={name:"dayName",props:{id:Number,name:String},computed:{dayName(){var t=["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],e=new Date(this.name),s=this.name.split("-");return`${t[e.getDay()]} ${s[2]}.${s[1]}.${s[0].slice(2)}`}}},X=J,U=(0,d.Z)(X,Y,V,!1,null,"fec4b184",null),G=U.exports,Q=function(){var t=this,e=t._self._c;return e("b-navbar",{attrs:{toggleable:!1,type:"white",variant:"light"}},[e("div",{staticClass:"container"},[e("b-navbar-brand",{attrs:{href:"/"}},[t._v("Расписание")]),t.iss?t._e():e("a",{staticClass:"nav-link",attrs:{href:"javascript://"},on:{click:function(e){return t.$emit("select-semester",0)}}},[t._v(t._s(t.selectedSemester)+" семестр")]),e("b-collapse",{staticStyle:{"justify-content":"right"},attrs:{id:"nav-collapse","is-nav":""}},[e("b-navbar-nav",{staticClass:"ml-auto"},[t.iss?e("b-nav-item",{attrs:{left:""},on:{click:function(e){return t.$emit("iss-click")}}},[e("small",[t._v("Обмен с ISS")])]):t._e(),t.login?e("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._v(t._s(t.login))]},proxy:!0}])},[e("b-dropdown-item",{attrs:{href:"javascript://"},on:{click:function(e){return t.$emit("select-semester",0)}}},[t._v("Семестр в ISS: "+t._s(t.selectedSemester)+" (сменить)")]),e("b-dropdown-divider"),e("b-dropdown-item",{attrs:{href:"javascript://"},on:{click:function(e){return t.$emit("get-iss-works")}}},[t._v("Выполнение нагрузки")]),e("b-dropdown-item",{attrs:{href:"javascript://"},on:{click:function(e){return t.$emit("add-self-lesson")}}},[t._v("Добавить занятия")]),e("b-dropdown-divider"),e("b-dropdown-item",{attrs:{href:"https://iss.vyatsu.ru/kaf"}},[t._v("Кабинет кафедры")]),e("b-dropdown-item",{attrs:{href:"https://new.vyatsu.ru/account/obr/rasp/?login=yes"}},[t._v("Расписание преподавателя")]),e("b-dropdown-item",{attrs:{href:"mailto:usr11935@vyatsu.ru"}},[t._v("Связь с разработчиком")]),e("b-dropdown-item",{attrs:{href:"/Timetable.apk"}},[t._v("Android приложение")]),e("b-dropdown-item",{attrs:{href:"javascript://"},on:{click:function(e){return t.$emit("get-api-token")}}},[t._v("Получить API token")]),e("b-dropdown-item",{attrs:{href:"javascript://"},on:{click:function(e){return t.$emit("logout")}}},[t._v("Выйти")])],1):e("b-nav-item-dropdown",{attrs:{right:"",id:"loginmenu"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._v("Войти")]},proxy:!0}],null,!1,2812716576)},[e("b-dropdown-form",{staticStyle:{"min-width":"280px"}},[e("b-dropdown-header",{attrs:{id:"dropdown-header-label"}},[t.loginErrorMessage?e("b-alert",{staticStyle:{"margin-bottom":"0",padding:"10px"},attrs:{show:"",variant:"danger"}},[e("center",[t._v(t._s(t.loginErrorMessage))])],1):e("center",[t._v("Авторизуйтесь и выберите"),e("br"),t._v("текущий семестр")])],1),e("b-form-group",{attrs:{label:"Логин","label-for":"dropdown-form-login"},on:{submit:function(t){t.stopPropagation(),t.preventDefault()}}},[e("b-form-input",{attrs:{id:"dropdown-form-login",size:"sm",placeholder:"usrxxxxx"}})],1),e("b-form-group",{attrs:{label:"Пароль","label-for":"dropdown-form-password"}},[e("b-form-input",{attrs:{id:"dropdown-form-password",type:"password",size:"sm"}})],1),e("b-form-group",{attrs:{label:"Семестр","label-for":"dropdown-form-semester"}},[e("b-button-group",{attrs:{id:"dropdown-form-semester",size:"sm"}},[e("b-button",{attrs:{pressed:1==t.selectedSemester,variant:"outline-primary"},on:{click:function(e){return t.$emit("select-semester",1)}}},[t._v("первый")]),e("b-button",{attrs:{pressed:2==t.selectedSemester,variant:"outline-primary"},on:{click:function(e){return t.$emit("select-semester",2)}}},[t._v("второй")])],1)],1),e("b-form-checkbox",{staticClass:"mb-3",staticStyle:{"margin-top":"6px"},attrs:{checked:t.remember},on:{input:e=>{t.$emit("input",e)}}},[t._v(" - запомнить меня")]),e("b-button",{staticStyle:{width:"100%"},attrs:{variant:"primary",size:"sm",block:""},on:{click:function(e){return t.$emit("save-settings")}}},[t._v("Войти")])],1)],1)],1)],1)],1)])},tt=[],et={name:"myNavBar",props:{login:String,remember:Boolean,iss:Boolean,showCopies:Boolean,loginErrorMessage:String,selectedSemester:Number}},st=et,at=(0,d.Z)(st,Q,tt,!1,null,null,null),nt=at.exports,it=function(){var t=this,e=t._self._c;return e("div",{staticClass:"week-selector-container"},[e("input",{staticClass:"form-control myweek container",staticStyle:{margin:"0 10px",width:"calc(100% - 20px)"},attrs:{id:"myweek",type:"week"},on:{change:t.changeWeek}})])},ot=[];function rt(t,e){var s=new Date(e,0,1+7*(t-1)),a=s.getDay(),n=s;return a<=4?n.setDate(s.getDate()-s.getDay()+1):n.setDate(s.getDate()+8-s.getDay()),n}function lt(t,e){var s=rt(t,e),a=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2);s.setDate(s.getDate()+6);var n=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2);return{start:a,end:n}}var ct={name:"myWeekSelector",methods:{changeWeek({target:t}){var e=t.value.split("-W"),s=lt(e[1],e[0]);console.log(s),this.$emit("change-week",s)}}},dt=ct,ut=(0,d.Z)(dt,it,ot,!1,null,null,null),bt=ut.exports,pt=function(){var t=this,e=t._self._c;return t.loading?e("center",[e("br"),e("br"),e("svg",{staticClass:"bi-stopwatch b-icon bi b-icon-animation-cylon",staticStyle:{"font-size":"300%"},attrs:{viewBox:"0 0 16 16",width:"1em",height:"1em",focusable:"false",role:"img","aria-label":"stopwatch",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"}},[e("g",[e("path",{attrs:{d:"M8.5 5.6a.5.5 0 1 0-1 0v2.9h-3a.5.5 0 0 0 0 1H8a.5.5 0 0 0 .5-.5V5.6z"}}),e("path",{attrs:{d:"M6.5 1A.5.5 0 0 1 7 .5h2a.5.5 0 0 1 0 1v.57c1.36.196 2.594.78 3.584 1.64a.715.715 0 0 1 .012-.013l.354-.354-.354-.353a.5.5 0 0 1 .707-.708l1.414 1.415a.5.5 0 1 1-.707.707l-.353-.354-.354.354a.512.512 0 0 1-.013.012A7 7 0 1 1 7 2.071V1.5a.5.5 0 0 1-.5-.5zM8 3a6 6 0 1 0 .001 12A6 6 0 0 0 8 3z"}})])]),e("div",[t._v(t._s(t.message))]),e("br"),e("br")]):t._e()},ht=[],mt={name:"raspLoadingShow",props:{loading:Boolean,message:String}},gt=mt,wt=(0,d.Z)(gt,pt,ht,!1,null,"61da57f8",null),vt=wt.exports,ft=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"straspwin",title:"Расписание студентов","ok-only":!0},on:{ok:t.winStudHide}},[e("b-overlay",{attrs:{show:t.winStud.loading,rounded:"sm"},on:{shown:t.onShown},scopedSlots:t._u([{key:"overlay",fn:function(){return[e("div",{staticClass:"text-center"},[e("b-icon",{attrs:{icon:"stopwatch","font-scale":"3",animation:"cylon"}}),e("p",{attrs:{id:"cancel-label"}},[t._v(t._s(t.winStud.message))]),e("b-button",{ref:"cancel",attrs:{variant:"outline-danger",size:"sm","aria-describedby":"cancel-label"},on:{click:t.winStudCancel}},[t._v(" Отменить ")])],1)]},proxy:!0}])},[e("p",{domProps:{innerHTML:t._s(t.winStud.rasp)}}),e("div",{staticClass:"row"},t._l(t.winStud.dates,(function(s,a){return e("button",{key:a,staticClass:"btn btn-light col-6 col-md-4",attrs:{type:"button"},on:{click:function(e){return t.$emit("get-st-rasp",{group:t.winStud.group,date:s})}}},[t._v(t._s(s))])})),0)])],1)},yt=[];const kt="";var _t={name:"stRaspWin",props:{winStud:Object,login:String},methods:{winStudHide(){this.$bvModal.hide("straspwin")},winStudCancel(){this.axios.post(kt+"/api/iss/closebrowser/",{username:this.login}).then((()=>{this.$bvModal.hide("straspwin")})).catch(console.log)},onShown(){this.$refs.cancel.focus()}}},St=_t,xt=(0,d.Z)(St,ft,yt,!1,null,null,null),Kt=xt.exports,Ct=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"kabraspwin",title:t.kabName,"ok-only":!0},on:{click:t.winKabHide,hidden:function(e){t.accShow=1}}},[e("b-overlay",{attrs:{show:t.winKab.loading,rounded:"sm"},on:{shown:t.onShown},scopedSlots:t._u([{key:"overlay",fn:function(){return[e("div",{staticClass:"text-center"},[e("b-icon",{attrs:{icon:"stopwatch","font-scale":"3",animation:"cylon"}}),e("p",{attrs:{id:"cancel-label"}},[t._v("Пожалуйста, подождите...")]),e("b-button",{ref:"cancel",attrs:{variant:"outline-danger",size:"sm","aria-describedby":"cancel-label"},on:{click:t.winKabHide}},[t._v("Отменить")])],1)]},proxy:!0}])},[t.winKab.loading?e("div",{staticStyle:{height:"300px"}}):e("div",{staticClass:"row"},[e("b-dropdown",{staticClass:"btn-group col-3",attrs:{id:"corplist",text:t.winKab.corps.find((e=>e==t.kabNameShort)),variant:"primary","menu-class":"w-100"}},t._l(t.winKab.corps,(function(s){return e("b-dropdown-item",{key:s,attrs:{id:`corp_${s}`,active:t.kabNameShort==s},on:{click:function(e){return t.$emit("set-corp",s)}}},[t._v(" "+t._s(s)+" ")])})),1),e("b-dropdown",{staticClass:"btn-group col-4",attrs:{id:"kablist",text:t.winKab.kabs[t.winKab.current.kab],variant:"primary","menu-class":"w-100"}},t._l(t.winKab.kabs,(function(s,a){return e("b-dropdown-item",{key:a,attrs:{id:`kab_${a}`,active:t.winKab.current.kab==a},on:{click:function(e){return t.$emit("set-kab",a)}}},[t._v(" "+t._s(s.split("-")[1])+" "+t._s(t.getDate!=t.winKab.dates[t.winKab.current.cDay].split(" ")[1]?"":t.winKab?.rasp[a]?.data[t.winKab.current.cDay]?.lessons[t.winKab.idl]?"🚫":"🆓")+" "+t._s(t.getInfo(s))+" ")])})),1),e("b-dropdown",{staticClass:"btn-group col-4",attrs:{id:"datlist",text:t.winKab.dates[t.winKab.current.cDay],variant:"primary","menu-class":"w-100",right:""}},t._l(t.winKab.dates,(function(s,a){return e("b-dropdown-item",{key:a,attrs:{id:`dat_${a}`,active:t.winKab.current.cDay==a},on:{click:function(e){return t.$emit("set-day",a)}}},[t._v(" "+t._s(s)+" ")])})),1),e("div",{staticClass:"accordion",staticStyle:{"padding-top":"16px"},attrs:{role:"tablist"}},[e("p",[t._v("Мест: "+t._s(t.kabInfo?.seats)+", доска: "+t._s(t.kabInfo?.board)+", "+t._s(t.kabInfo?.type)+", "+t._s(t.kabInfo?.tv?"ТВ":"")+" "+t._s(t.kabInfo?.projector?"проектор":""))]),e("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[e("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[e("b-button",{attrs:{block:"",variant:"light"},on:{click:function(e){t.accShow=3-t.accShow}}},[t._v("Расписание кабинета")])],1),e("b-collapse",{attrs:{id:"accordion-1",visible:1==t.accShow,accordion:"my-accordion",role:"tabpanel"}},[e("b-card-body",{staticStyle:{padding:"0"}},[t.winKab.rasp.length*t.winKab.kabs.length*t.winKab.dates.length?e("div",{staticClass:"col-12"},[e("table",{staticClass:"b-table table table-bordered table-striped bv-docs-table"},t._l(t.lessons,(function(s,a){return e("tr",{key:a,class:t.winKab.idl==a&&t.getDate==t.winKab.dates[t.winKab.current.cDay].split(" ")[1]?"currlesson":"",on:{click:()=>{t.winKab.idl==a&&t.getDate==t.winKab.dates[t.winKab.current.cDay].split(" ")[1]&&(t.accShow=2)},dblclick:()=>{t.winKab.idl==a&&t.getDate==t.winKab.dates[t.winKab.current.cDay].split(" ")[1]&&(t.$emit("change-kab",t.winKab.kabs[t.winKab.current.kab]),t.winKabHide())}}},[e("th",{staticStyle:{padding:"10px"},attrs:{scope:"col"}},[e("small",[t._v(t._s(a+1))])]),e("td",[e("small",[t._v(t._s(s||"Свободно"))])])])})),0)]):t._e()])],1)],1),t.winKab.lesson?.oldkab?e("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[e("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[e("b-button",{attrs:{block:"",variant:"light"},on:{click:function(e){t.accShow=3-t.accShow}}},[t._v("Отменить замену кабинета")])],1),e("b-collapse",{attrs:{id:"accordion-2",visible:2==t.accShow,accordion:"my-accordion",role:"tabpanel"}},[e("b-card-body",[e("b-alert",{staticStyle:{"flex-shrink":"inherit"},attrs:{show:""}},[e("center",[t._v(" Чтобы отменить замену кабинета "),e("b",[t._v(t._s(t.winKab.lesson?.oldkab))]),t._v(" на "),e("b",[t._v(t._s(t.winKab.lesson?.kab))]),e("br"),t._v(" для занятия "),e("b",[t._v(t._s(t.winKab.lesson?.predm))]),t._v(" от "),e("b",[t._v(t._s(t.getDate))]),t._v(", "),e("b",[t._v(t._s(t.winKab.lesson?.time&&t.winKab.lesson?.time.split("-")[0]))]),t._v(", "),e("br"),t._v(" нажмите кнопку"),e("br"),e("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.$emit("change-kab-cancel")}}},[t._v("Отменить замену")])],1)],1)],1)],1)],1):e("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[e("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[e("b-button",{attrs:{block:"",variant:"light"},on:{click:function(e){t.accShow=3-t.accShow}}},[t._v(t._s(t.winKab.lesson?.kab&&"___"==t.winKab.lesson?.kab.split("-")[1]?"Установка":"Замена")+" кабинета")])],1),e("b-collapse",{attrs:{id:"accordion-2",visible:2==t.accShow,accordion:"my-accordion",role:"tabpanel"}},[e("b-card-body",[t.winKab.lesson?.kab!=t.winKab.kabs[t.winKab.current.kab]&&t.getDate==t.winKab.dates[t.winKab.current.cDay].split(" ")[1]?e("b-alert",{staticStyle:{"flex-shrink":"inherit"},attrs:{show:""}},[e("center",[t._v(" Чтобы "+t._s(t.winKab.lesson?.kab&&"___"==t.winKab.lesson?.kab.split("-")[1]?"установить":"заменить")+" кабинет "),e("span",{domProps:{innerHTML:t._s(t.oldKabText)}}),t._v(" "),e("b",[t._v(t._s(t.winKab.kabs[t.winKab.current.kab]))]),e("br"),t._v(" для занятия "),e("b",[t._v(t._s(t.winKab.lesson?.predm))]),t._v(" от "),e("b",[t._v(t._s(t.getDate))]),t._v(", "),e("b",[t._v(t._s(t.winKab.lesson?.time&&t.winKab.lesson?.time.split("-")[0]))]),t._v(", "),e("br"),t._v("нажмите кнопку"),e("br"),e("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.$emit("change-kab",t.winKab.kabs[t.winKab.current.kab])}}},[t._v(t._s(t.winKab.lesson?.kab&&"___"==t.winKab.lesson?.kab.split("-")[1]?"Установить":"Заменить"))])],1)],1):t._e(),t.winKab.lesson?.kab==t.winKab.kabs[t.winKab.current.kab]&&t.getDate==t.winKab.dates[t.winKab.current.cDay].split(" ")[1]?e("b-alert",{staticStyle:{"flex-shrink":"inherit"},attrs:{variant:"warning",show:""}},[e("center",[t._v(" Чтобы заменить кабинет "),e("b",[t._v(t._s(t.winKab.lesson?.kab))]),e("br"),t._v(" для занятия "),e("b",[t._v(t._s(t.winKab.lesson?.predm))]),t._v(" от "),e("b",[t._v(t._s(t.getDate))]),t._v(", "),e("b",[t._v(t._s(t.winKab.lesson?.time&&t.winKab.lesson?.time.split("-")[0]))]),t._v(", выберите свободный из списка кабинетов. ")])],1):t._e(),t.getDate!=t.winKab.dates[t.winKab.current.cDay].split(" ")[1]?e("b-alert",{staticStyle:{"flex-shrink":"inherit"},attrs:{variant:"warning",show:""}},[e("center",[t._v(" Чтобы заменить кабинет "),e("b",[t._v(t._s(t.winKab.lesson?.kab))]),e("br"),t._v(" для занятия "),e("b",[t._v(t._s(t.winKab.lesson?.predm))]),t._v(" от "),e("b",[t._v(t._s(t.getDate))]),t._v(", "),e("b",[t._v(t._s(t.winKab.lesson?.time&&t.winKab.lesson?.time.split("-")[0]))]),t._v(", выберите корректную дату из списка дат. ")])],1):t._e()],1)],1)],1)],1)],1)])],1)},$t=[],Dt={name:"kabWin",props:{winKab:Object},data:()=>({accShow:1}),computed:{kabName(){var t=this.winKab.current.kab,e=t>-1?this.winKab.kabs[t]?.split("-")[0]:"";return e=e?`${e} корпуса`:"",`Кабинеты ${e}`},kabNameShort(){var t=this.winKab.current.kab,e=t>-1?this.winKab.kabs[t]?.split("-")[0]:"";return e},lessons(){var t=this.winKab.current.kab>-1?this.winKab.current.kab:0,e=this.winKab.current.cDay>-1?this.winKab.current.cDay:0;return this.winKab.rasp[t].data[e].lessons},getDate(){return new Date(this.winKab.day).toLocaleDateString().replace(".20",".")},oldKabText(){return this.winKab.lesson?.kab&&"___"==this.winKab.lesson?.kab.split("-")[1]?"":"<b>"+this.winKab.lesson?.kab+"</b> на"},kabInfo(){return this.winKab.types.find((t=>t.kab==this.winKab.kabs[this.winKab.current.kab]))}},methods:{onShown(){this.$refs.cancel.focus()},winKabHide(){this.$bvModal.hide("kabraspwin")},getInfo(t){var e=this.winKab.types.find((e=>e.kab==t));return e?("к"==e.type[0]?"💻":"")+(e.projector?"🎥 ":"")+(e.tv?"📺":""):""}}},Et=Dt,Mt=(0,d.Z)(Et,Ct,$t,!1,null,"4a9f1135",null),At=Mt.exports,Lt=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"logwin",title:"Журнал нагрузки","ok-only":!0},on:{click:t.winLogHide}},[e("table",{staticClass:"table"},[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Дата")]),e("th",{attrs:{scope:"col"}},[t._v("Кол-во")]),e("th",{attrs:{scope:"col"}},[t._v("Кабинет")])]),t._l(t.winLog.log,(function(s,a){return e("tr",{key:a,staticClass:"small"},[e("th",{attrs:{scope:"row"}},[t._v(t._s(s[0]))]),e("td",[t._v(t._s(s[1])+" ч.")]),e("td",[t._v(t._s(s[2]))])])}))],2)])},Nt=[],Ot={name:"logWin",props:{winLog:Object},methods:{winLogHide(){this.$bvModal.hide("logwin")}}},Tt=Ot,jt=(0,d.Z)(Tt,Lt,Nt,!1,null,null,null),It=jt.exports,Wt=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"syncwin",size:"xl",title:"Выполнение нагрузки","ok-only":!0},on:{click:t.winSyncHide}},[e("table",{staticClass:"b-table table table-bordered table-striped bv-docs-table"},[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Предмет")]),e("th",{attrs:{scope:"col"}},[t._v("Проведено (ч.)")])]),t._l(t.winSync.data,(function(s,a){return e("tr",{key:a,staticClass:"small lesson",on:{click:function(e){return t.$emit("lesson-select",s)}}},[e("td",[e("b",[t._v(t._s(s.name))]),e("br"),e("i",[t._v(t._s(t.lesType(s.cat)))]),e("br"),e("small",[t._v(t._s(s.groups))])]),e("td",{staticStyle:{"padding-right":"10px"}},[e("b-progress",{staticStyle:{padding:"0px","background-color":"rgb(153 153 153 / 40%)"},attrs:{max:100}},[e("b-progress-bar",{staticStyle:{overflow:"visible"},attrs:{value:s.percent,label:`${s.info}`}})],1)],1)])}))],2)])},Bt=[],zt={name:"syncWin",props:{winSync:Object},methods:{winSyncHide(){this.$bvModal.hide("syncwin")},lesType(t){return 0==t?"Лекции":1==t?"Семинары":2==t?"Лабораторные":void 0}}},Ht=zt,Pt=(0,d.Z)(Ht,Wt,Bt,!1,null,null,null),Zt=Pt.exports,Ft=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"loaderwin",title:"Лог загрузки","ok-only":!0},on:{click:t.winLoaderHide}},[e("div",{staticClass:"modal-body console-log",attrs:{id:"my-event"}},[t._l(t.messages,(function(s,a){return e("div",{key:a,staticClass:"small"},[t._v(" > "),e("span",{style:"color: "+s.color},[t._v(t._s(s.message))])])})),e("br"),e("br")],2)])},qt=[],Rt={name:"loaderWin",props:{messages:Array},methods:{winLoaderHide(){this.$bvModal.hide("loaderwin")}}},Yt=Rt,Vt=(0,d.Z)(Yt,Ft,qt,!1,null,"66618ff0",null),Jt=Vt.exports,Xt=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"selfleswin",size:"xl",title:"Добавление занятия","ok-only":!0},on:{ok:t.winHide}},[e("b-tabs",{attrs:{"content-class":"mt-3"}},[e("b-tab",{attrs:{title:"Импорт из .xlsx",active:""}},[e("xlsxImportVue",{attrs:{days:t.days},on:{"export-lessons":t.exportLessons}})],1),e("b-tab",{attrs:{title:"Ручное добавление"}},[e("b-form-datepicker",{staticClass:"mb-2",attrs:{locale:"ru"},model:{value:t.rec.day,callback:function(e){t.$set(t.rec,"day",e)},expression:"rec.day"}}),e("b-form-select",{staticClass:"mb-2",attrs:{options:t.times},model:{value:t.rec.lesson.time,callback:function(e){t.$set(t.rec.lesson,"time",e)},expression:"rec.lesson.time"}}),e("b-form-input",{staticClass:"mb-2",attrs:{placeholder:"Предмет"},model:{value:t.rec.lesson.predm,callback:function(e){t.$set(t.rec.lesson,"predm",e)},expression:"rec.lesson.predm"}}),e("b-form-select",{staticClass:"mb-2",attrs:{options:t.types},model:{value:t.rec.lesson.type,callback:function(e){t.$set(t.rec.lesson,"type",e)},expression:"rec.lesson.type"}}),e("b-form-input",{staticClass:"mb-2",attrs:{placeholder:"Кабинет"},model:{value:t.rec.lesson.kab,callback:function(e){t.$set(t.rec.lesson,"kab",e)},expression:"rec.lesson.kab"}}),e("b-form-input",{staticClass:"mb-2",attrs:{placeholder:"Группа"},model:{value:t.rec.lesson.groups,callback:function(e){t.$set(t.rec.lesson,"groups",e)},expression:"rec.lesson.groups"}}),e("b-button",{attrs:{variant:"primary"},on:{click:t.addLessonBtnClick}},[t._v("Добавить занятие в расписание")])],1)],1)],1)},Ut=[],Gt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"mt-3"},[e("h3",[t._v("Загрузка расписания колледжа ВятГУ")]),t._m(0),e("input",{staticClass:"form-control",attrs:{type:"file",accept:".xlsx"},on:{change:t.fileChanged}}),e("b-alert",{staticStyle:{"margin-top":"16px"},attrs:{show:0==t.lessons.length,variant:"warning"}},[t._v("Перед загрузкой файла требуется отменить объединение всех ячеек. Парсер не умеет работать с объединенными ячейками.")]),e("label",[t._v("Текущий год:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentYear,expression:"currentYear"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.currentYear},on:{input:function(e){e.target.composing||(t.currentYear=e.target.value)}}}),e("label",[t._v("Преподаватель:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.teather,expression:"teather"}],staticClass:"form-control",attrs:{type:"search"},domProps:{value:t.teather},on:{input:function(e){e.target.composing||(t.teather=e.target.value)}}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"table_to_parse"},domProps:{innerHTML:t._s(t.html)}})],1),t.lessons.length>0?e("div",{staticClass:"card mt-3"},[e("b-table",{ref:"selectableTable",attrs:{items:t.lessonsFiltered,fields:t.fields,"select-mode":"multi",responsive:"sm",selectable:""},on:{"row-selected":t.onRowSelected},scopedSlots:t._u([{key:"cell(selected)",fn:function({rowSelected:s}){return[s?[e("span",{attrs:{"aria-hidden":"true"}},[t._v("✓")])]:[e("span",{attrs:{"aria-hidden":"true"}},[t._v(" ")])]]}}],null,!1,3632317190)}),e("p",[t._v("   "),e("b-button",{attrs:{size:"sm"},on:{click:t.selectAllRows}},[t._v("Выбрать все")]),t._v("  "),e("b-button",{attrs:{size:"sm"},on:{click:t.clearSelected}},[t._v("Снять выбор")]),t._v("  "),t.selected.length>0?e("b-button",{attrs:{variant:"primary"},on:{click:t.exportLessons}},[t._v("Добавить "),e("b-badge",{staticStyle:{"background-color":"white",color:"black"},attrs:{variant:"light"}},[t._v(t._s(t.selected.length))]),t._v(" занятий в расписание")],1):t._e()],1)],1):t._e()])},Qt=[function(){var t=this,e=t._self._c;return e("label",[t._v("Файл "),e("code",[t._v(".xlsx")]),t._v(" с расписанием:")])}],te=s(7092),ee={name:"xlsImport",props:["days"],computed:{lessonsFiltered(){return this.lessons.filter((t=>-1!=t.teather.indexOf(this.teather)))}},data(){return{html:"",teather:"Марков",currentYear:"",lessons:[],fields:[{key:"selected",label:"✓"},{key:"day",label:"День"},{key:"time",label:"Пара"},{key:"predm",label:"Предмет"},{key:"type",label:"Тип"},{key:"groups",label:"Группы"},{key:"teather",label:"Преподаватель"},{key:"kab",label:"Кабинет"}],selected:[]}},methods:{onRowSelected(t){this.selected=t},selectAllRows(){this.$refs.selectableTable.selectAllRows()},clearSelected(){this.$refs.selectableTable.clearSelected()},fileChanged({target:t}){let e=t.files[0];if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type)return console.log("Unknown File Format: "+e.type),null;const s=new FileReader;s.readAsArrayBuffer(e),s.onload=()=>{this.parseXlsx(s.result)}},async parseXlsx(t){const e=["8:20-9:50","10:00-11:30","11:45-13:15","14:00-15:30","15:45-17:15","17:20-18:50","18:55-20:25"],s=[20,21,34,35,48,49,62,63,76,77,90,91,92,93,94,95,96,97,110,111,124,125,138,139,152,153,166,167,180,181,194,195,208,209],a=(0,te.ij)(t);this.html=te.P6.sheet_to_html(a.Sheets[a.SheetNames[0]]),setTimeout((()=>{let t=window.document.querySelector("#table_to_parse"),a=t.querySelectorAll("tr");var n=0,i=[];let o=a[23].querySelectorAll("td");o.forEach(((t,e)=>{if(e>7&&92!=e&&""!=t.textContent){let s=t.textContent.replaceAll("Группа","").trim().replace(/\s+/g,",").split(",");s.length>0&&""!=s[0]&&(i.push({grs:s,key:e}),n=e)}})),this.lessons=[];var r=a.length,l={day:"",lesson:0};for(let u=25;u<r;u++){let t=a[u].querySelectorAll("td");if(""!=t[6].textContent){let e=t[6].textContent.split(" "),s=e[e.length-1].trim().split("."),a=`${this.currentYear}-${s[1]}-${s[0]}`;l.day=a,l.lesson=0}else l.lesson++;let o=8;while(o<=n){if(-1==s.indexOf(o)){if(""!=t[o].textContent){var c={day:l.day,time:e[l.lesson],predm:t[o].textContent,groups:i.find((t=>t.key==o))?.grs,type:t[o+1].textContent,teather:t[o+2].textContent,kab:t[o+3].textContent},d=this.lessons.find((t=>t.day==c.day&&t.time==c.time&&t.kab==c.kab));d?d.groups=Array.prototype.concat(d.groups,c.groups):(c._rowVariant=this.lessonInDaysStatus(c),this.lessons.push(c))}o+=3}o++}}this.html=""}),300)},lessonInDaysStatus(t){var e=this.days.find((e=>e.day==t.day));if(!e)return"warning";var s=e.lessons.find((e=>e.time==t.time));return s?""==s.predm?"":s.predm!=t.predm?"danger":"success":"warning"},exportLessons(){this.$emit("export-lessons",this.selected)}},mounted(){this.currentYear=(new Date).getFullYear()}},se=ee,ae=(0,d.Z)(se,Gt,Qt,!1,null,null,null),ne=ae.exports,ie={name:"selfLesWin",components:{xlsxImportVue:ne},props:["days"],data(){return{rec:{day:"",lesson:{time:"8:20-9:50",predm:"",type:"Лекция",kab:"",groups:""}},types:[{value:"Лекция",text:"Лекция"},{value:"Практика",text:"Практика"},{value:"Лабораторная",text:"Лабораторная"},{value:"Другое",text:"Другое"}],times:[{value:"8:20-9:50",text:"1: 8:20-9:50"},{value:"10:00-11:30",text:"2: 10:00-11:30"},{value:"11:45-13:15",text:"3: 11:45-13:15"},{value:"14:00-15:30",text:"4: 14:00-15:30"},{value:"15:45-17:15",text:"5: 15:45-17:15"},{value:"17:20-18:50",text:"6: 17:20-18:50"},{value:"18:55-20:25",text:"7: 18:55-20:25"}]}},methods:{winHide(){this.$bvModal.hide("selfleswin")},addLessonBtnClick(){this.$emit("lesson-add",this.rec)},exportLessons(t){this.$emit("lesson-add-multi",t)}}},oe=ie,re=(0,d.Z)(oe,Xt,Ut,!1,null,null,null),le=re.exports;const ce="";var de={name:"App",mixins:[L,O,P,F,R],components:{lessonName:b,lessonContent:v,lessonMenu:x,lessonCopyBlock:M,dayName:G,myNavBar:nt,myWeekSelector:bt,raspLoadingShow:vt,stRaspWin:Kt,kabWin:At,syncWin:Zt,logWin:It,loaderWin:Jt,selfLesWin:le},computed:{filteredDays(){return this.days.filter((t=>"NaN-aN-aN"==this.weekFilter.start||t.day>=this.weekFilter.start&&t.day<=this.weekFilter.end))}},data:()=>({days:[],weekFilter:{start:"NaN-aN-aN",end:"NaN-aN-aN"}}),methods:{prompt(t,e){return prompt(t,e)},Number(t){return Number(t)},async loadData(){if("true"==localStorage.remember&&(this.login=localStorage.login,this.passwordAES=localStorage.passwordAES,this.remember=!0),this.days=[],!this.login)return document.querySelector('li[id="loginmenu"] a').click(),0;var t=t=>{setTimeout((()=>{window.location.href="#"+t}),300)};if(localStorage.dump){var e=JSON.parse(localStorage.dump),s=this.today();e.forEach(((e,a)=>{e.day==s&&t(a)})),this.days=e}else this.loading=!0;this.$pusher.unsubscribe(this.login);var a=this.$pusher.subscribe(this.login);a.bind("my-event",(t=>{this.messages.push(t),this.winStud.message=t.message;var e=document.getElementById("my-event");e&&(e.scrollTop=e?.scrollHeight+100)})),this.axios.post(ce+"/api/rasp",{login:this.login,passwordAES:this.passwordAES}).then((e=>{this.loading=!1;var s=this.today();e.data.forEach(((e,a)=>{e.lessons.forEach((t=>{t.i=void 0,t.variants=void 0,t.status="",t.showmenu=!1,"copied"in t||(t.copied=!1),t.unsaved=!1,t.stkab=""})),localStorage.dump||e.day!=s||t(a)})),localStorage.dump=JSON.stringify(e.data),this.days=e.data})).catch((({response:t})=>{this.loading=!1,this.logout(),this.loginErrorMessage=t.data.error}))},changeWeek(t){this.weekFilter=t,window.location.href="#0"},issCheckClick(t){this.axios.post(ce+"/api/iss/del-iss-label-for-lesson",{_id:t._id}).then((()=>{t.in_iss=0}))}},mounted(){this.loadData(),window.dump={}}},ue=de,be=(0,d.Z)(ue,n,i,!1,null,null,null),pe=be.exports,he=s(5996),me=s(9425),ge=s(2879),we=s.n(ge),ve=s(6265),fe=s.n(ve),ye=s(6423);s(7024);a["default"].use(ye.Z,fe()),a["default"].use(we(),{api_key:"499bb8d44438cabb3eab",options:{cluster:"eu",logToConsole:!0}}),a["default"].use(he.XG7),a["default"].use(me.A7),a["default"].config.productionTip=!1,new a["default"]({render:t=>t(pe)}).$mount("#app")},8631:function(t,e,s){t.exports=s.p+"img/copy.3be67d20.svg"},4828:function(t,e,s){t.exports=s.p+"img/del.7d35e880.svg"},2781:function(t,e,s){t.exports=s.p+"img/home.7ab3c342.svg"},214:function(t,e,s){t.exports=s.p+"img/journal.24c2d41c.svg"},8324:function(t,e,s){t.exports=s.p+"img/student.c4f83879.svg"}},e={};function s(a){var n=e[a];if(void 0!==n)return n.exports;var i=e[a]={id:a,loaded:!1,exports:{}};return t[a](i,i.exports,s),i.loaded=!0,i.exports}s.m=t,function(){s.amdO={}}(),function(){var t=[];s.O=function(e,a,n,i){if(!a){var o=1/0;for(d=0;d<t.length;d++){a=t[d][0],n=t[d][1],i=t[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&i||o>=i)&&Object.keys(s.O).every((function(t){return s.O[t](a[l])}))?a.splice(l--,1):(r=!1,i<o&&(o=i));if(r){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[a,n,i]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){s.p="/"}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,i,o=a[0],r=a[1],l=a[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(l)var d=l(s)}for(e&&e(a);c<o.length;c++)i=o[c],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(d)},a=self["webpackChunkvue"]=self["webpackChunkvue"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(4783)}));a=s.O(a)})();
//# sourceMappingURL=app.668a7997.js.map